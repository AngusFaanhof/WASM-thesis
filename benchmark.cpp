#include <immintrin.h>
#include <iostream>
#include <random>
#include <chrono>

#include "sources/MatrixMultiplication.h"
#include "sources/MatrixAddition.h"
#include "sources/DotProduct.h"

int EXPERIMENT_ITERATIONS = 100;

int main(int argc, char** args) {
	// loaddata()

	int data[EXPERIMENT_ITERATIONS];

	int a[] = {605,990,914,772,628,755,634,603,949,459,271,618,393,516,628,353,151,658,23,796,142,203,189,748,856,447,684,992,775,421,125,61,175,546,384,653,202,702,798,933,737,123,327,614,209,22,964,435,110,143,727,954,923,714,749,162,990,900,376,849,838,454,47,547,877,621,814,495,529,767,526,951,665,342,933,936,655,15,709,723,944,481,619,788,305,190,351,279,75,97,48,115,434,618,167,793,719,77,684,305,368,864,266,144,633,624,303,250,340,89,523,826,95,812,588,11,968,680,920,674,371,57,145,279,216,999,250,688,49,868,27,148,526,799,727,755,175,316,563,747,967,54,807,914,655,626,156,211,908,911,940,810,391,692,972,477,753,913,236,10,565,556,491,906,608,894,891,448,667,33,28,671,952,735,135,441,134,683,637,603,167,77,306,893,461,533,1000,282,28,532,34,876,712,132,33,426,973,31,855,52,155,574,30,362,545,315,665,869,758,775,500,559,40,439,117,935,240,104,956,563,112,503,204,780,122,48,993,536,757,250,309,14,319,856,479,363,915,815,728,174,717,216,189,96,948,55,365,473,549,127,237,622,897,896,850,829,663,902,295,504,182,394,618,760,623,242,143,874,117,456,954,94,907,643,212,200,73,703,145,308,207,355,474,663,994,368,991,801,762,620,755,36,84,954,828,739,508,521,364,371,380,87,425,823,290,496,589,24,30,200,638,345,745,784,145,859,147,73,584,65,252,876,994,679,735,824,917,464,280,221,762,719,514,601,745,880,983,574,225,94,406,42,431,708,785,730,821,894,373,320,248,354,51,896,283,837,334,169,949,298,752,932,126,908,98,301,696,151,875,358,784,543,529,974,897,625,730,853,368,277,647,847,328,15,657,466,701,827,446,753,926,816,778,340,542,756,845,294,717,922,394,359,804,730,72,171,131,99,240,533,406,381,79,638,480,242,505,412,561,325,431,601,608,428,558,192,235,528,613,363,393,442,867,884,646,304,291,503,660,420,130,90,708,553,271,577,436,214,261,578,235,320,578,728,883,341,886,936,60,284,522,68,732,823,599,856,644,902,177,58,359,184,437,595,740,814,397,64,271,758,702,266,22,331,592,434,951,930,418,621,850,913,186,499,309,7,55,105,555,581,177,247,58,239,443,234,351,315,683,469,955,799};

	int b[] = {605,990,914,772,628,755,634,603,949,459,271,618,393,516,628,353,151,658,23,796,142,203,189,748,856,447,684,992,775,421,125,61,175,546,384,653,202,702,798,933,737,123,327,614,209,22,964,435,110,143,727,954,923,714,749,162,990,900,376,849,838,454,47,547,877,621,814,495,529,767,526,951,665,342,933,936,655,15,709,723,944,481,619,788,305,190,351,279,75,97,48,115,434,618,167,793,719,77,684,305,368,864,266,144,633,624,303,250,340,89,523,826,95,812,588,11,968,680,920,674,371,57,145,279,216,999,250,688,49,868,27,148,526,799,727,755,175,316,563,747,967,54,807,914,655,626,156,211,908,911,940,810,391,692,972,477,753,913,236,10,565,556,491,906,608,894,891,448,667,33,28,671,952,735,135,441,134,683,637,603,167,77,306,893,461,533,1000,282,28,532,34,876,712,132,33,426,973,31,855,52,155,574,30,362,545,315,665,869,758,775,500,559,40,439,117,935,240,104,956,563,112,503,204,780,122,48,993,536,757,250,309,14,319,856,479,363,915,815,728,174,717,216,189,96,948,55,365,473,549,127,237,622,897,896,850,829,663,902,295,504,182,394,618,760,623,242,143,874,117,456,954,94,907,643,212,200,73,703,145,308,207,355,474,663,994,368,991,801,762,620,755,36,84,954,828,739,508,521,364,371,380,87,425,823,290,496,589,24,30,200,638,345,745,784,145,859,147,73,584,65,252,876,994,679,735,824,917,464,280,221,762,719,514,601,745,880,983,574,225,94,406,42,431,708,785,730,821,894,373,320,248,354,51,896,283,837,334,169,949,298,752,932,126,908,98,301,696,151,875,358,784,543,529,974,897,625,730,853,368,277,647,847,328,15,657,466,701,827,446,753,926,816,778,340,542,756,845,294,717,922,394,359,804,730,72,171,131,99,240,533,406,381,79,638,480,242,505,412,561,325,431,601,608,428,558,192,235,528,613,363,393,442,867,884,646,304,291,503,660,420,130,90,708,553,271,577,436,214,261,578,235,320,578,728,883,341,886,936,60,284,522,68,732,823,599,856,644,902,177,58,359,184,437,595,740,814,397,64,271,758,702,266,22,331,592,434,951,930,418,621,850,913,186,499,309,7,55,105,555,581,177,247,58,239,443,234,351,315,683,469,955,799};

	// int c* = new int[10];

	for (int i = 0; i < EXPERIMENT_ITERATIONS; i++) {
		auto start = std::chrono::high_resolution_clock::now();

		MatrixAddition(a, b, 512);

		auto end = std::chrono::high_resolution_clock::now();
		auto duration = std::chrono::duration_cast<std::chrono::nanoseconds>(end - start);

		// savedata()
		data[i] = duration.count();
	}

	// write out to file
	// data
	// 0: {MS}ms
	// 1: {MS}ms
	// ..
	// 9: {MS}ms

	for (int i = 0; i < EXPERIMENT_ITERATIONS; i++) {
		std::cout << i << ": " << data[i] << "Ms" << std::endl;
	}


	return 0;
}